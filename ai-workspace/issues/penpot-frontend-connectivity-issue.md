# Penpot Frontend Connectivity Issue Report

**Date:** September 23, 2025, 11:11 PM EST  
**Reporter:** Cline AI Assistant  
**Severity:** High  
**Status:** Open  

## Issue Summary

The penpot-frontend container is running but not responding to HTTP requests on port 9001. The service shows "health: starting" status and returns "Empty reply from server" when accessed via curl.

## Symptoms

1. **HTTP Connection Issues:**
   - `curl http://localhost:9001/` returns "Empty reply from server" (error 52)
   - TCP connection is established but no HTTP response is received
   - Health check remains in "starting" state for extended periods

2. **Container Status:**
   - Container state: `running: starting`
   - Health status: `health: starting` (stuck in this state)
   - No error logs visible in container output
   - Container has been running for 2+ minutes without becoming healthy

## Investigation Results

### Container Details
```
NAME: penpot-frontend
IMAGE: penpotapp/frontend:2.9.0
COMMAND: "/bin/bash /entrypoiâ€¦"
STATUS: Up 2 minutes (health: starting)
PORTS: 8080/tcp, 0.0.0.0:9001->9001/tcp, :::9001->9001/tcp
```

### Network Connectivity Test
```bash
$ curl -v http://localhost:9001/
* Connected to localhost (127.0.0.1) port 9001
> GET / HTTP/1.1
> Host: localhost:9001
> User-Agent: curl/8.7.1
> Accept: */*
> 
* Request completely sent off
* Empty reply from server
* Closing connection
curl: (52) Empty reply from server
```

### Container Logs
- **Issue:** No logs are being generated by the penpot-frontend container
- **Command:** `docker logs penpot-frontend` returns empty output
- **Implication:** The container may be failing silently during startup

### Related Services Status
- âœ… **penpot-backend:** Healthy (responding on port 6060)
- âœ… **penpot-db:** Healthy (PostgreSQL running)
- âœ… **penpot-redis:** Healthy (Redis running)
- ðŸŸ¡ **penpot-exporter:** health: starting (but responding with HTTP 400 on port 6061)

## Environment Configuration

### Docker Compose Configuration
```yaml
penpot-frontend:
  image: penpotapp/frontend:2.9.0
  profiles: ["penpot"]
  container_name: penpot-frontend
  depends_on:
    penpot-backend:
      condition: service_healthy
  ports:
    - "9001:9001"
  environment:
    PENPOT_PUBLIC_URI: http://localhost:9001
  volumes:
    - penpot_assets:/opt/data
  networks:
    - content-automation-network
  healthcheck:
    test: ["CMD-SHELL", "curl -fsS -o /dev/null http://localhost:9001/ || exit 1"]
    interval: 15s
    timeout: 5s
    retries: 20
    start_period: 60s
```

### Environment Variables
- `PENPOT_PUBLIC_URI`: http://localhost:9001

## Potential Root Causes

1. **Application Startup Failure:**
   - Frontend application may be failing to start properly
   - No error logs suggest silent failure or logging configuration issue

2. **Port Binding Issues:**
   - Internal port 9001 may not be properly bound by the application
   - Port mapping appears correct in Docker configuration

3. **Health Check Configuration:**
   - Health check may be too aggressive or using wrong endpoint
   - Current health check uses same endpoint that's failing

4. **Dependency Issues:**
   - Frontend may require additional time to connect to backend
   - Backend dependency is marked as healthy, so this is less likely

5. **Image/Version Issues:**
   - penpotapp/frontend:2.9.0 image may have compatibility issues
   - Consider testing with different version tags

## Recommended Actions

### Immediate Actions
1. **Check container process status:**
   ```bash
   docker exec penpot-frontend ps aux
   ```

2. **Inspect container filesystem:**
   ```bash
   docker exec penpot-frontend ls -la /opt/
   ```

3. **Test internal connectivity:**
   ```bash
   docker exec penpot-frontend curl -v http://localhost:9001/
   ```

### Diagnostic Actions
1. **Enable verbose logging:**
   - Add environment variables for debug logging
   - Check if Penpot frontend supports debug mode

2. **Test alternative health check:**
   - Try different health check endpoints
   - Consider using TCP check instead of HTTP

3. **Network troubleshooting:**
   - Verify internal network connectivity
   - Check if frontend can reach backend services

### Configuration Changes
1. **Update health check:**
   ```yaml
   healthcheck:
     test: ["CMD-SHELL", "nc -z localhost 9001 || exit 1"]
     interval: 30s
     timeout: 10s
     retries: 10
     start_period: 120s
   ```

2. **Add debug environment variables:**
   ```yaml
   environment:
     PENPOT_PUBLIC_URI: http://localhost:9001
     PENPOT_DEBUG: "true"
     NODE_ENV: "development"
   ```

## Impact Assessment

- **Severity:** High - Penpot frontend is completely inaccessible
- **User Impact:** Users cannot access Penpot web interface
- **System Impact:** Other services (backend, exporter) are functional
- **Business Impact:** Design/prototyping workflows are blocked

## Next Steps

1. Execute immediate diagnostic actions
2. Implement recommended configuration changes
3. Monitor container startup with verbose logging
4. Consider rollback to previous working version if issue persists
5. Escalate to Penpot community/support if image-level issue is confirmed

## Related Issues

- Container startup analysis: `container-startup-analysis-report.md`
- Docker configuration: `docker-configuration-analysis.md`

---

**Last Updated:** September 23, 2025, 11:11 PM EST  
**Next Review:** September 24, 2025, 12:00 PM EST
